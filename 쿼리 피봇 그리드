ë”ë¯¸ ë°ì´í„° ìƒì„± í•¨ìˆ˜ (ì¡°ê±´ ë°˜ì˜)
ì½”ë“œ ë³µì‚¬
Js
// utils/dummySqlResult.js

/**
 * ì„¤ë¹„ë³„ë¡œ a~g ê°’ì„ ìƒì„±í•˜ëŠ” ë”ë¯¸ í•¨ìˆ˜
 * @param {string[]} eqps - ì„¤ë¹„ëª… ëª©ë¡ (['eqp1','eqp2',...])
 * @returns {Array} SQL ê²°ê³¼ì™€ ìœ ì‚¬í•œ ë°°ì—´
 *
 * ì˜ˆ:
 * [
 *   { eqp: 'eqp1', a: 12.34, b: 56.7, c: 78.9, d: 45.12, e: 67.8, f: 1234, g: 2999 },
 *   { eqp: 'eqp2', a: 10.1,  b: 20.45, ... },
 * ]
 */
export function generateDummySqlResult(eqps) {
  // a~eëŠ” ì†Œìˆ˜ì  1~2ìë¦¬, f/gëŠ” ì •ìˆ˜
  const getFloatValue = () => {
    const base = Math.floor(Math.random() * 90) + 10; // 10~99 (ì‹­ì˜ ìë¦¬ ì´ìƒ)
    const decimals = Math.random() < 0.5
      ? +(Math.random().toFixed(1)) // ì†Œìˆ˜ì  1ìë¦¬
      : +(Math.random().toFixed(2)); // ì†Œìˆ˜ì  2ìë¦¬
    return +(base + decimals).toFixed(decimals === 0 ? 1 : (decimals.toString().length - 2));
  };

  const getIntValue = () => Math.floor(Math.random() * 3000); // 0~2999

  return eqps.map(eqp => ({
    eqp,
    a: getFloatValue(),
    b: getFloatValue(),
    c: getFloatValue(),
    d: getFloatValue(),
    e: getFloatValue(),
    f: getIntValue(),
    g: getIntValue(),
  }));
}
ğŸ” ê²°ê³¼ ì˜ˆì‹œ
ì½”ë“œ ë³µì‚¬
Js
generateDummySqlResult(['eqp1','eqp2']);
ë¦¬í„´ê°’ ì˜ˆ:
ì½”ë“œ ë³µì‚¬
Json
[
  {
    "eqp": "eqp1",
    "a": 45.67,
    "b": 23.4,
    "c": 88.12,
    "d": 12.3,
    "e": 67.45,
    "f": 1200,
    "g": 2999
  },
  {
    "eqp": "eqp2",
    "a": 34.5,
    "b": 56.78,
    "c": 91.2,
    "d": 43.67,
    "e": 78.1,
    "f": 234,
    "g": 1567
  }
]



-------------------------------------------------

Vue2 + ag-Grid í‘œì‹œ êµ¬ì¡°
SQL ê²°ê³¼ëŠ” "í–‰ = ì„¤ë¹„", "ì»¬ëŸ¼ = í•­ëª©(ag)"ì¸ë°, ì§€ìš°ë‹˜ì´ ì›í•˜ì‹œëŠ” ê±´
**í–‰ = í•­ëª©(ag), ë™ì  ì»¬ëŸ¼ = ì„¤ë¹„ ëª©ë¡**ì´ë¯€ë¡œ í”¼ë²— ë³€í™˜ì´ í•„ìš”í•©ë‹ˆë‹¤.
ì½”ë“œ ë³µì‚¬
Js
// utils/pivot.js

/**
 * SQL ê²°ê³¼ (í–‰=ì„¤ë¹„) â†’ ê·¸ë¦¬ë“œ í–‰ (í–‰=í•­ëª©)
 *
 * @param {Array} sqlRows - SQL ê²°ê³¼ [{eqp:'eqp1', a:..., b:..., ...}, ...]
 * @param {string[]} eqps - ì„¤ë¹„ ëª©ë¡
 * @returns {Array} ê·¸ë¦¬ë“œì— ë„£ì„ í–‰ [{item:'a', eqp1:ê°’, eqp2:ê°’,...}, ...]
 */
export function pivotSqlResult(sqlRows, eqps) {
  const items = ['a','b','c','d','e','f','g'];
  return items.map(item => {
    const row = { item };
    for (const eqp of eqps) {
      const found = sqlRows.find(r => r.eqp === eqp);
      row[eqp] = found ? found[item] : null;
    }
    return row;
  });
}
3. Vue2 ì»´í¬ë„ŒíŠ¸ ì˜ˆì‹œ
ì½”ë“œ ë³µì‚¬
Vue
<template>
  <div class="ag-theme-alpine" style="width:100%;height:500px;">
    <ag-grid-vue
      :columnDefs="columnDefs"
      :rowData="rowData"
      :defaultColDef="defaultColDef"
      @grid-ready="onGridReady"
    />
  </div>
</template>

<script>
import { AgGridVue } from 'ag-grid-vue';
import 'ag-grid-community/styles/ag-grid.css';
import 'ag-grid-community/styles/ag-theme-alpine.css';

import { generateDummySqlResult } from '@/utils/dummySqlResult';
import { pivotSqlResult } from '@/utils/pivot';

export default {
  name: 'EqpDynamicGrid',
  components: { AgGridVue },

  props: {
    eqps: {
      type: Array,
      required: true,
    },
    sqlRows: {
      type: Array,
      default: () => null,
    },
  },

  data() {
    return {
      columnDefs: [],
      rowData: [],
      defaultColDef: {
        resizable: true,
        sortable: true,
      },
    };
  },

  mounted() {
    this.rebuildGrid();
  },

  methods: {
    onGridReady(params) {
      this.gridApi = params.api;
    },

    rebuildGrid() {
      const raw = this.sqlRows && this.sqlRows.length
        ? this.sqlRows
        : generateDummySqlResult(this.eqps);

      const rows = pivotSqlResult(raw, this.eqps);

      // ì»¬ëŸ¼ ì •ì˜: ê³ ì • + ë™ì 
      const fixed = [{ headerName: 'í•­ëª©', field: 'item', pinned: 'left' }];
      const dynamic = this.eqps.map(e => ({ headerName: e, field: e }));
      this.columnDefs = [...fixed, ...dynamic];
      this.rowData = rows;
    },
  },
};
</script>



