âœ… ì „ì œ ì¡°ê±´
flowchartContainer: flowchartì˜ ì „ì²´ ë°°ê²½ ì˜ì—­ í¬ê¸°
flowchartNodeBounds: flowchartì—ì„œ ì‹¤ì œ ë…¸ë“œê°€ ê·¸ë ¤ì§€ëŠ” ì˜ì—­ í¬ê¸° ë° ìœ„ì¹˜
minimapContainer: minimapì˜ ì „ì²´ ë°°ê²½ ì˜ì—­ í¬ê¸°
minimapNodeBounds: minimapì—ì„œ ì‹¤ì œ ë…¸ë“œê°€ ê·¸ë ¤ì§€ëŠ” ì˜ì—­ í¬ê¸° ë° ìœ„ì¹˜
ì´ë•Œ, flowchartì™€ minimapì€ ì„œë¡œ ê°€ë¡œ/ì„¸ë¡œ ë¹„ìœ¨ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


ğŸ”¹ 1. Flowchartì—ì„œ ì´ë™ ì¢Œí‘œì™€ ìŠ¤ì¼€ì¼ê°’ ì–»ê¸° (flowchart.vue)

// flowchart.vue
methods: {
  getFlowchartPanZoomState() {
    const { x, y, scale } = this.panzoomInstance.getTransform();
    return { x, y, scale };
  }
}

ğŸ”¹ 2. Minimapì—ì„œ Flowchart ìƒíƒœê°’ì„ ë°›ì•„ ì‚¬ê°í˜• ë°•ìŠ¤ ìœ„ì¹˜ ë° í¬ê¸° ê³„ì‚° (navigationView.vue)

// navigationView.vue
methods: {
  updateViewportRect(flowchartTransform) {
    const { x: translateX, y: translateY, scale } = flowchartTransform;

    // ì‹¤ì œ ë…¸ë“œ ì˜ì—­ í¬ê¸°
    const fcWidth = this.flowchartNodeBounds.width;
    const fcHeight = this.flowchartNodeBounds.height;

    // ë¯¸ë‹ˆë§µ ë…¸ë“œ ì˜ì—­ í¬ê¸°
    const mmWidth = this.minimapNodeBounds.width;
    const mmHeight = this.minimapNodeBounds.height;

    // ê° ì¶•ë³„ ë¹„ìœ¨ ê³„ì‚° (ê°€ë¡œ/ì„¸ë¡œ ë”°ë¡œ ê³„ì‚°)
    const scaleRatioX = mmWidth / fcWidth;
    const scaleRatioY = mmHeight / fcHeight;

    // í˜„ì¬ flowchart ì»¨í…Œì´ë„ˆì˜ ë³´ì´ëŠ” ì˜ì—­ í¬ê¸° (ì‹¤ì œ í™•ëŒ€ë¹„ìœ¨ ê³ ë ¤)
    const visibleWidth = this.flowchartContainer.clientWidth / scale;
    const visibleHeight = this.flowchartContainer.clientHeight / scale;

    // ë¯¸ë‹ˆë§µì—ì„œ ì‚¬ê°í˜• ë°•ìŠ¤ ìœ„ì¹˜ ë° í¬ê¸° ê³„ì‚° (ê° ì¶•ë³„ ë…ë¦½ì  ê³„ì‚°)
    const minimapRectX = (-translateX / scale) * scaleRatioX + this.minimapNodeBounds.left;
    const minimapRectY = (-translateY / scale) * scaleRatioY + this.minimapNodeBounds.top;
    const minimapRectWidth = visibleWidth * scaleRatioX;
    const minimapRectHeight = visibleHeight * scaleRatioY;

    // ê°’ ë³€ê²½ ì—¬ë¶€ í™•ì¸ í›„ ì—…ë°ì´íŠ¸
    if (
      this.viewportRect.x !== minimapRectX ||
      this.viewportRect.y !== minimapRectY ||
      this.viewportRect.width !== minimapRectWidth ||
      this.viewportRect.height !== minimapRectHeight
    ) {
      this.viewportRect = {
        x: minimapRectX,
        y: minimapRectY,
        width: minimapRectWidth,
        height: minimapRectHeight
      };
    }
  }
}

ğŸ”¹ 3. Minimapì—ì„œ í´ë¦­ ì‹œ í´ë¦­ ìœ„ì¹˜ ì–»ê¸° (navigationView.vue)

// navigationView.vue
methods: {
  onMinimapClick(event) {
    const rect = event.currentTarget.getBoundingClientRect();
    
    // í´ë¦­í•œ ì¢Œí‘œë¥¼ minimapContainer ê¸°ì¤€ìœ¼ë¡œ ì–»ìŒ
    const clickX = event.clientX - rect.left;
    const clickY = event.clientY - rect.top;

    return { x: clickX, y: clickY };
  }
}

ğŸ”¹ 4. Minimap í´ë¦­ ì¢Œí‘œë¥¼ Flowchart ì¢Œí‘œë¡œ ë³€í™˜ (flowchart.vue)

// flowchart.vue
methods: {
  getFlowchartCoordsFromMinimapClick(minimapClickCoords, flowchartNodeBounds, minimapNodeBounds) {

    // ê° ì¶•ë³„ ë¹„ìœ¨ ê³„ì‚° (ê°€ë¡œ/ì„¸ë¡œ ë”°ë¡œ ê³„ì‚°)
    const ratioX = flowchartNodeBounds.width / minimapNodeBounds.width;
    const ratioY = flowchartNodeBounds.height / minimapNodeBounds.height;

    // FlowChart ìƒì˜ ì‹¤ì œ ëŒ€ì‘ ì¢Œí‘œ ê³„ì‚° (minimap ë…¸ë“œì˜ì—­ ê¸°ì¤€ìœ¼ë¡œ ë³€í™˜)
    const targetFlowChartX = (minimapClickCoords.x - minimapNodeBounds.left) * ratioX;
    const targetFlowChartY = (minimapClickCoords.y - minimapNodeBounds.top) * ratioY;

    return { x: targetFlowChartX, y: targetFlowChartY };
  }
}
